{% extends "index.html" %}
{% block page_content %}

<h1 class="title">APACHE</h1>

	{% with messages = get_flashed_messages() %}
	  {% if messages %}
	    <ul class=flashes>
	    {% for message in messages %}
	      <li>{{ message }}</li>
	    {% endfor %}
	    </ul>
	    <meta http-equiv="refresh" content="5;URL=http://localhost:5000/sites">
	  {% endif %}
	{% endwith %}
	<br>
	{% if logStatus|length > 0 %}
		<ul>
		{% for key,value in logStatus.data.items() %}
			<li>{{ key }} : {{ value }}</li>
		{% endfor %}
		</ul>
	{% endif %}

<div class="page-header button-style">
	<ul class="nav nav-pills" style="display: flex;justify-content: space-between;">
	  <!-- queste sono tutte form, non devo scendere su una nuova pagina -->
	  <li role="presentation" id="startButton">
	  	<form id="startApache" action="/startApache" role="form" method="POST">
       		<input type = "submit" value = "Start" id="buttonStartApache" name="b-start"/>
    	</form>
	  </li>
	  <li role="presentation" id="stopButton">
	   	<form id="stopApache" action="/stopApache" role="form" method="POST">
       		<input type = "submit" value = "Stop" id="buttonStopApache" name="b-stop-a"/>
    	</form>
	  </li>
	  <li role="presentation" id="restartButton">
	  	<form id="restartApache" action="/restartApache" role="form" method="POST">
       		<input type = "submit" value = "Restart" id="buttonRestartApache" name="b-restart-a"/>
    	</form>
	  </li>
	  <li role="presentation" id="reloadButton">
	  	<form id="reloadApache" action="/reloadApache" role="form" method="POST">
       		<input type = "submit" value = "Reload" id="buttonReloadApache" name="b-reload-a"/>
    	</form>
	  </li>
	  <li role="presentation" id="statusButton" >
	  	<form id="statusApache" action="/statusApache" role="form" method="POST">
       		<input type = "submit" value = "Status" id="buttonStatusApache" name="b-status-a"/>
    	</form>
	  </li>
	</ul>
	<p id="pText" hidden> To activate new settings you must restart or reload apache </p>
</div>

	<div class="tab-content">
	    <div id="sites">
	        <h3 class="title">Sites</h3>
		  	{% for vd in vhost.data %}
		      <div class="row apacheRow">
		        	<div class="col-md-6"> 
			        	<h2 style="text-align: center;"><button style="font-size: 28px;" type="button" data-toggle="modal" class="btn btn-link" data-target="#modalUpdSite">{{v['filename'][:-5]}}</button></h2>
			      	</div>
			        <div class="col-md-4" style="padding-top: 18px;"> 
			          <table>
			            <tr>
			             <td> Site Folder (DocumentRoot): &ensp;</td>
			             <td> {{ v['DocumentRoot'] }} </td>
			            </tr>
			            <tr>
			             <td> filename: &ensp;</td>
			             <td> {{ v['filename'] }} </td>
			            </tr>
			            <tr>
			             <td> active: &ensp;</td>
			             {% if v['active'] == 1 %}
				            <td>
					            <form id="deactivateVHost" action="/deactivateVHost" role="form" method="POST">
					           		<input type="hidden" value="{{v['filename']}}" name="clickDeactiv">
				       		 		<button class="button b-round-g" id="buttonSClickDeactiv"></button>
				    			</form>
			    			</td>
			             <!--<td><button class="button b-round-g" value="" id="buttonClickActiv"></button></td>-->
			             {% else %}
				            <td>
					            <form id="activateVHost" action="/activateVHost" role="form" method="POST">
					           		<input type="hidden" value="{{v['filename']}}" name="clickActiv">
				       		 		<button class="button b-round-r" id="buttonSClickActiv"></button>
				    			</form>
			    			</td>
			             {% endif %}
			            </tr> 
			        </table>
			      </div>		
		      </div>
		    {% endfor %}
		</div>
	</div> 


<div id = "modalUpdSite" class = "modal fade" role="dialog">
	<div class = "modal-dialog"> 
		<div class = "modal-content"> 
			<div class = "modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Modifica contenuto site</h4>
			</div>
			<div class="modal-body">
			<form id="form" action="/updateSiteFolder" role="form" method = "POST">
					Site: <input type="text" id="vhostUpdate" name="vhostUpdate" value="{{v['filename']}}" class="form-control" readonly />
	          		<!--Nuovo comando shell:<input type="text" id="newShell" name="newShell" class="form-control" placeholder="-- Seleziona nuova shell --"/>-->

	          	<div class="form-group">
				  <label for="content">Contenuto site:</label>
				  <!-- textarea che ritorna da readfile -->
				</div>
        	</div>	
        	<div class="modal-footer">
        		<!--<button id = "btnUpd" class="btn btn-info btn-default">Invio</button>-->
        		<input type = "submit" value = "Invio" class="btn btn-info btn-default">
          		<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        	</div>
        	</form>	
        </div>	
	</div>
</div>

{% endblock %}